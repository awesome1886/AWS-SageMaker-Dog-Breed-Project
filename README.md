# README: Image Classification using AWS SageMaker

## Project Overview
In this project, I used AWS SageMaker to build an image classification model that identifies dog breeds. I used transfer learning with a pre-trained ResNet50 model and fine-tuned it on the Dog Breed dataset. The project demonstrates the end-to-end machine learning engineering pipeline, including data preparation, hyperparameter tuning, model profiling/debugging, and deployment.

## Dataset
The dataset used is the [Dog Breed Classification](https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/dogImages.zip) dataset.
- **Input:** Images of dogs.
- **Classes:** 133 distinct dog breeds.
- **Structure:** Divided into training, validation, and testing subdirectories.

## Model Architecture
I used **ResNet50**, a mighty Convolutional Neural Network (CNN) pre-trained on ImageNet.
- **Transfer Learning:** I froze the early convolutional layers to retain the learned features (edges, textures).
- **Fully Connected Layer:** I replaced the final fully connected layer with a new linear layer adapted to the 133 output classes of the dog dataset.
- **Loss Function:** CrossEntropyLoss.
- **Optimizer:** Adam.

## Hyperparameter Tuning
I used SageMaker's `HyperparameterTuner` to optimize the model performance.
- **Hyperparameters Tuned:**
  - `lr` (Learning Rate): Continuous range [0.001, 0.1]
  - `batch-size`: Categorical values [32, 64]
  - `epochs`: Fixed at 2 for tuning to save resources.
- **Best Hyperparameters:**
  - Learning Rate: 0.001
  - Batch Size: 64

## Debugging and Profiling
I implemented **SageMaker Debugger and Profiler** to monitor the training process.
- **Debugger Rules:** I enabled rules to check for vanishing gradients, overfitting, loss not decreasing, and poor weight initialization.
- **Profiler:** I configured the profiler to track system metrics (CPU/GPU utilization) every 500ms.
- **Results:** The `profiler-report.html` (included in this repository) provides a detailed analysis of the hardware usage and training stability.

## Model Deployment
The final model was deployed to a SageMaker Endpoint (`ml.m5.large` instance) for real-time inference.
- **Inference Script:** The `train.py` script includes a `model_fn` to load the saved model artifacts correctly.
- **Testing:** The endpoint was successfully queried with a test image, returning a predicted class index.

## File Structure
- `train_and_deploy.ipynb`: The Jupyter Notebook containing the orchestration code (Data upload, Tuning, Training, Deployment).
- `train.py`: The Python script for training the model (includes data loaders, model architecture, and debugging hooks).
- `hpo.py`: A copy of the training script explicitly used for the Hyperparameter Tuning job.
- `profiler-report.html`: The HTML report generated by SageMaker Profiler during the final training job.
- `README.md`: Project documentation.